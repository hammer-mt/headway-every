<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Find family counseling in New York | Headway</title>
  <style>
    /* Reset & Base */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      color: #1a1a1a;
      background: #fff;
      line-height: 1.5;
    }
    a { color: inherit; text-decoration: none; }
    button { cursor: pointer; font-family: inherit; }
    img { display: block; max-width: 100%; }

    /* Headway brand colors */
    :root {
      --green-dark: #166534;
      --green-mid: #16a34a;
      --green-light: #dcfce7;
      --cream: #fef9f0;
      --bg-light: #f7f7f5;
      --bg-footer: #eef0eb;
      --text-primary: #1a1a1a;
      --text-secondary: #6b7280;
      --border-color: #e5e7eb;
    }

    /* Typography */
    .font-serif {
      font-family: Georgia, 'Times New Roman', Times, serif;
    }

    /* Layout */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 24px;
    }

    /* ===== NAVBAR ===== */
    .navbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 40px;
      border-bottom: 1px solid var(--border-color);
      position: sticky;
      top: 0;
      background: #fff;
      z-index: 100;
    }
    .navbar-logo {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 24px;
      font-weight: 700;
      color: var(--green-dark);
    }
    .navbar-logo svg {
      width: 32px;
      height: 32px;
    }
    .navbar-links {
      display: flex;
      align-items: center;
      gap: 32px;
      font-size: 15px;
      color: var(--text-primary);
    }
    .navbar-links a:hover { color: var(--green-dark); }
    .navbar-actions {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .btn-outline {
      padding: 10px 20px;
      border: 1.5px solid var(--text-primary);
      border-radius: 999px;
      background: transparent;
      font-size: 14px;
      font-weight: 600;
    }
    .btn-primary {
      padding: 10px 20px;
      border: none;
      border-radius: 999px;
      background: var(--green-dark);
      color: #fff;
      font-size: 14px;
      font-weight: 600;
    }
    .btn-primary:hover { background: #14532d; }

    /* ===== HERO SECTION ===== */
    .hero {
      padding: 64px 0;
      background: linear-gradient(to bottom, #fff 0%, var(--bg-light) 100%);
    }
    .hero-inner {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 48px;
      align-items: center;
    }
    .hero-content h2 {
      font-family: Georgia, serif;
      font-size: 48px;
      font-weight: 400;
      line-height: 1.15;
      color: var(--text-primary);
      margin-bottom: 8px;
    }
    .hero-content h1 {
      font-size: 16px;
      font-weight: 400;
      color: var(--text-secondary);
      margin-bottom: 32px;
    }
    .hero-form {
      display: flex;
      align-items: flex-end;
      gap: 12px;
      flex-wrap: wrap;
    }
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .form-group label {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
    }
    .form-group label span {
      font-weight: 400;
      color: var(--text-secondary);
      margin-left: 4px;
    }
    .input-with-icon {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 16px;
      border: 1.5px solid var(--border-color);
      border-radius: 12px;
      background: #fff;
      font-size: 15px;
      min-width: 160px;
    }
    .input-with-icon input {
      border: none;
      outline: none;
      font-size: 15px;
      width: 100%;
      font-family: inherit;
    }
    .input-with-icon select {
      border: none;
      outline: none;
      font-size: 15px;
      width: 100%;
      font-family: inherit;
      color: var(--text-secondary);
      background: transparent;
      -webkit-appearance: none;
    }
    .insurance-input {
      min-width: 280px;
    }
    .btn-find {
      padding: 14px 32px;
      background: var(--green-dark);
      color: #fff;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
    }
    .btn-find:hover { background: #14532d; }
    .hero-image {
      width: 100%;
      height: 340px;
      border-radius: 16px;
      overflow: hidden;
      background: linear-gradient(135deg, #a7c4a0 0%, #6b9b6b 50%, #d4a76a 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 14px;
      font-style: italic;
    }

    /* ===== COST ESTIMATE BANNER ===== */
    .cost-banner {
      margin: 0 auto;
      max-width: 1200px;
      padding: 0 24px;
    }
    .cost-banner-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 24px 32px;
      background: var(--bg-light);
      border-radius: 16px;
      margin-bottom: 48px;
    }
    .cost-banner-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .cost-icon {
      width: 48px;
      height: 48px;
      background: linear-gradient(135deg, var(--green-light), #bbf7d0);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }
    .cost-banner h4 {
      font-size: 16px;
      font-weight: 700;
    }
    .cost-banner p {
      font-size: 14px;
      color: var(--text-secondary);
    }
    .arrow-link {
      font-size: 24px;
      color: var(--text-primary);
      text-decoration: none;
    }

    /* ===== THERAPIST SECTION ===== */
    .therapists-section {
      padding: 0 0 48px;
    }
    .therapists-section h3 {
      font-family: Georgia, serif;
      font-size: 32px;
      font-weight: 400;
      margin-bottom: 12px;
    }
    .therapists-intro {
      font-size: 15px;
      color: var(--text-secondary);
      max-width: 800px;
      margin-bottom: 32px;
      line-height: 1.6;
    }

    /* Card Grid */
    .card-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      margin-bottom: 40px;
    }

    /* Therapist Card */
    .therapist-card {
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 24px;
      background: #fff;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    .card-header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 20px;
    }
    .card-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 700;
      font-size: 24px;
    }
    .card-name {
      font-family: Georgia, serif;
      font-size: 24px;
      font-weight: 400;
    }
    .card-role {
      font-size: 14px;
      color: var(--text-secondary);
    }
    .card-location {
      font-size: 14px;
      color: var(--text-secondary);
    }
    .card-quote {
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 20px;
      line-height: 1.6;
      flex-grow: 1;
    }
    .card-detail {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      margin-bottom: 10px;
      font-size: 14px;
    }
    .card-detail-icon {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--green-dark);
      margin-top: 1px;
    }
    .card-detail-icon svg {
      width: 18px;
      height: 18px;
    }
    .card-detail strong {
      font-weight: 700;
    }
    .card-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: auto;
      padding-top: 16px;
      gap: 12px;
    }
    .next-opening {
      font-size: 14px;
      color: var(--text-secondary);
    }
    .free-consult {
      font-size: 13px;
      color: var(--green-dark);
      font-weight: 600;
    }
    .btn-view-profile {
      padding: 10px 20px;
      background: var(--text-primary);
      color: #fff;
      border: none;
      border-radius: 999px;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
    }
    .btn-view-profile:hover {
      background: #333;
    }

    /* ===== PAGINATION ===== */
    .pagination {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
      margin-bottom: 8px;
    }
    .pagination button {
      width: 36px;
      height: 36px;
      border: none;
      border-radius: 8px;
      background: transparent;
      font-size: 14px;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .pagination button.active {
      background: var(--bg-light);
      font-weight: 700;
    }
    .pagination button:hover:not(.active) {
      background: #f3f4f6;
    }
    .pagination-info {
      text-align: center;
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 48px;
    }
    .pagination-info a {
      color: var(--text-primary);
      text-decoration: underline;
    }

    /* ===== FAQ SECTION ===== */
    .faq-section {
      padding: 64px 0;
    }
    .faq-inner {
      display: grid;
      grid-template-columns: 1fr 1.5fr;
      gap: 64px;
      align-items: start;
    }
    .faq-left h3 {
      font-family: Georgia, serif;
      font-size: 36px;
      font-weight: 400;
      line-height: 1.2;
      margin-bottom: 32px;
    }
    .faq-illustration {
      width: 260px;
      height: 200px;
      background: linear-gradient(135deg, #c2703e 0%, #d4956a 50%, #f5deb3 100%);
      border-radius: 16px;
    }
    .faq-item {
      border-top: 1px solid var(--border-color);
      padding: 20px 0;
    }
    .faq-question {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      background: none;
      border: none;
      font-size: 16px;
      font-weight: 400;
      text-align: left;
      cursor: pointer;
      padding: 0;
      color: var(--text-primary);
    }
    .faq-question:hover { color: var(--green-dark); }
    .faq-chevron {
      font-size: 20px;
      transition: transform 0.2s;
      flex-shrink: 0;
      margin-left: 16px;
    }
    .faq-answer {
      display: none;
      padding-top: 12px;
      font-size: 14px;
      line-height: 1.7;
      color: var(--text-secondary);
    }
    .faq-item.open .faq-answer { display: block; }
    .faq-item.open .faq-chevron { transform: rotate(180deg); }

    /* ===== CTA SECTION ===== */
    .cta-section {
      padding: 64px 0;
    }
    .cta-inner {
      display: grid;
      grid-template-columns: 1fr 1fr;
      border-radius: 16px;
      overflow: hidden;
      min-height: 300px;
    }
    .cta-image {
      background: linear-gradient(135deg, #5b7fa6 0%, #7ba3c9 50%, #9fc5e8 100%);
    }
    .cta-content {
      background: var(--cream);
      padding: 64px 48px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .cta-content h3 {
      font-family: Georgia, serif;
      font-size: 32px;
      font-weight: 400;
      line-height: 1.2;
      margin-bottom: 16px;
    }
    .cta-content p {
      font-size: 15px;
      color: var(--text-secondary);
      margin-bottom: 24px;
      line-height: 1.6;
    }
    .btn-find-match {
      display: inline-block;
      padding: 14px 28px;
      background: var(--text-primary);
      color: #fff;
      border: none;
      border-radius: 12px;
      font-size: 15px;
      font-weight: 600;
      width: fit-content;
    }

    /* ===== FIND A PROVIDER TABS ===== */
    .provider-tabs-section {
      padding: 64px 0 32px;
    }
    .provider-tabs-section h3 {
      font-family: Georgia, serif;
      font-size: 32px;
      font-weight: 400;
      margin-bottom: 24px;
    }
    .tabs {
      display: flex;
      gap: 24px;
      border-bottom: 1px solid var(--border-color);
      margin-bottom: 24px;
    }
    .tab-btn {
      padding: 8px 0;
      background: none;
      border: none;
      border-bottom: 2px solid transparent;
      font-size: 15px;
      color: var(--text-secondary);
      cursor: pointer;
    }
    .tab-btn.active {
      color: var(--green-dark);
      border-bottom-color: var(--green-dark);
      font-weight: 600;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px 32px;
    }
    .tab-content a {
      font-size: 15px;
      color: var(--text-primary);
      padding: 4px 0;
    }
    .tab-content a:hover {
      color: var(--green-dark);
    }

    /* ===== BREADCRUMBS ===== */
    .breadcrumbs {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 24px 0;
      border-top: 1px solid var(--border-color);
      font-size: 14px;
      color: var(--text-secondary);
    }
    .breadcrumbs-nav {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .breadcrumbs-nav a {
      color: var(--text-secondary);
    }
    .breadcrumbs-nav a:hover {
      color: var(--green-dark);
    }
    .breadcrumbs-nav span {
      color: var(--text-secondary);
    }

    /* ===== DISCLAIMER ===== */
    .disclaimer {
      padding: 32px 0;
      font-size: 13px;
      color: var(--text-secondary);
    }

    /* ===== FOOTER ===== */
    .footer {
      background: var(--bg-footer);
      padding: 64px 0 40px;
    }
    .footer-top {
      display: grid;
      grid-template-columns: 1.5fr 1fr 1fr 1fr 1fr;
      gap: 32px;
      margin-bottom: 48px;
    }
    .footer-logo {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 24px;
      font-weight: 700;
      color: var(--green-dark);
      margin-bottom: 16px;
    }
    .footer-col h4 {
      font-size: 14px;
      font-weight: 700;
      margin-bottom: 16px;
      color: var(--text-primary);
    }
    .footer-col a {
      display: block;
      font-size: 14px;
      color: var(--text-secondary);
      padding: 4px 0;
    }
    .footer-col a:hover { color: var(--green-dark); }
    .footer-bottom {
      display: grid;
      grid-template-columns: 1fr 2fr 1fr;
      gap: 32px;
      border-top: 1px solid var(--border-color);
      padding-top: 32px;
      font-size: 13px;
      color: var(--text-secondary);
    }
    .footer-social {
      display: flex;
      gap: 16px;
      margin-top: 12px;
    }
    .footer-social a {
      width: 36px;
      height: 36px;
      border: 1px solid var(--border-color);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-primary);
      font-size: 16px;
    }
    .footer-crisis a {
      color: var(--text-primary);
      text-decoration: underline;
    }
    .footer-crisis strong {
      font-weight: 700;
    }
    .footer-legal a {
      display: block;
      padding: 2px 0;
      color: var(--text-secondary);
    }
    .footer-legal a:hover { color: var(--green-dark); }

    /* ===== STICKY BOTTOM BAR ===== */
    .sticky-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #fff;
      border-top: 1px solid var(--border-color);
      padding: 14px 40px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      z-index: 100;
      box-shadow: 0 -2px 8px rgba(0,0,0,0.06);
    }
    .sticky-bar p {
      font-size: 15px;
    }
    .btn-get-started {
      padding: 12px 24px;
      background: var(--green-dark);
      color: #fff;
      border: none;
      border-radius: 999px;
      font-size: 14px;
      font-weight: 600;
    }

    /* ===== VIEW TOGGLE ===== */
    .view-toggle-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 24px;
    }
    .view-toggle {
      display: flex;
      background: var(--bg-light);
      border-radius: 10px;
      padding: 4px;
      gap: 2px;
    }
    .view-toggle button {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 16px;
      border: none;
      border-radius: 8px;
      background: transparent;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.2s;
    }
    .view-toggle button.active {
      background: #fff;
      color: var(--text-primary);
      font-weight: 600;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .view-toggle button svg { width: 16px; height: 16px; }

    /* ===== MAP VIEW ===== */
    .map-container {
      display: none;
      position: relative;
      width: 100%;
      height: 600px;
      background: #e8ecf0;
      border-radius: 16px;
      overflow: hidden;
      margin-bottom: 40px;
    }
    .map-container.active { display: block; }
    .map-svg {
      width: 100%;
      height: 100%;
    }
    .map-pin {
      cursor: pointer;
      transition: r 0.15s;
    }
    .map-pin:hover { r: 8; }
    .map-popup {
      display: none;
      position: absolute;
      background: #fff;
      border-radius: 14px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      padding: 20px;
      width: 300px;
      z-index: 10;
      pointer-events: auto;
    }
    .map-popup.visible { display: block; }
    .map-popup-close {
      position: absolute;
      top: 10px;
      right: 12px;
      background: none;
      border: none;
      font-size: 18px;
      color: var(--text-secondary);
      cursor: pointer;
      line-height: 1;
    }
    .map-popup-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }
    .map-popup-avatar {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 700;
      font-size: 16px;
      flex-shrink: 0;
    }
    .map-popup-name {
      font-family: Georgia, serif;
      font-size: 18px;
    }
    .map-popup-role {
      font-size: 13px;
      color: var(--text-secondary);
    }
    .map-popup-detail {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: 6px;
      line-height: 1.5;
    }
    .map-popup-link {
      display: inline-block;
      margin-top: 8px;
      padding: 8px 16px;
      background: var(--text-primary);
      color: #fff;
      border-radius: 999px;
      font-size: 13px;
      font-weight: 600;
    }
    .map-legend {
      position: absolute;
      bottom: 16px;
      left: 16px;
      background: rgba(255,255,255,0.92);
      backdrop-filter: blur(6px);
      border-radius: 10px;
      padding: 12px 16px;
      font-size: 12px;
      color: var(--text-secondary);
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    }
    .map-legend-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 4px;
    }
    .map-legend-row:last-child { margin-bottom: 0; }
    .map-legend-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    /* ===== RESPONSIVE ===== */
    @media (max-width: 768px) {
      .navbar { padding: 12px 16px; }
      .navbar-links { display: none; }
      .hero-inner { grid-template-columns: 1fr; }
      .hero-image { height: 220px; }
      .hero-content h2 { font-size: 32px; }
      .card-grid { grid-template-columns: 1fr; }
      .faq-inner { grid-template-columns: 1fr; }
      .cta-inner { grid-template-columns: 1fr; }
      .cta-image { height: 200px; }
      .footer-top { grid-template-columns: 1fr 1fr; }
      .footer-bottom { grid-template-columns: 1fr; }
      .tab-content.active { grid-template-columns: 1fr 1fr; }
      .hero-form { flex-direction: column; align-items: stretch; }
      .insurance-input { min-width: unset; }
      .map-container { height: 400px; }
    }
  </style>
</head>
<body>

  <!-- ===== NAVBAR ===== -->
  <nav class="navbar">
    <a href="#" class="navbar-logo">
      <svg viewBox="0 0 32 32" fill="none">
        <rect width="32" height="24" rx="6" fill="#166534" y="8"/>
        <rect width="22" height="16" rx="4" fill="#16a34a" x="5" y="2"/>
      </svg>
      Headway
    </a>
    <div class="navbar-links">
      <a href="#">Find care</a>
      <a href="#">For providers</a>
      <a href="#">For health plans</a>
      <a href="#">Company</a>
    </div>
    <div class="navbar-actions">
      <button class="btn-outline">Log in</button>
      <button class="btn-primary">Find a therapist</button>
    </div>
  </nav>

  <!-- ===== HERO ===== -->
  <section class="hero">
    <div class="container">
      <div class="hero-inner">
        <div class="hero-content">
          <h2>Book family therapy, covered by insurance</h2>
          <h1>Family therapy and counseling in New York</h1>
          <div class="hero-form">
            <div class="form-group">
              <label>Zip code</label>
              <div class="input-with-icon">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#9ca3af" stroke-width="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="3"/></svg>
                <input type="text" value="07097" id="zipInput" />
              </div>
            </div>
            <div class="form-group">
              <label>Insurance <span>Optional</span></label>
              <div class="input-with-icon insurance-input">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#9ca3af" stroke-width="2"><rect x="2" y="5" width="20" height="14" rx="2"/><line x1="2" y1="10" x2="22" y2="10"/></svg>
                <select id="insuranceSelect">
                  <option value="">All insurance carriers</option>
                  <option value="Aetna">Aetna</option>
                  <option value="Anthem">Anthem Blue Cross and Blue Shield</option>
                  <option value="Blue Cross Blue Shield">Blue Cross Blue Shield</option>
                  <option value="Carelon">Carelon Behavioral Health</option>
                  <option value="Cigna">Cigna</option>
                  <option value="Highmark">Highmark BlueCross BlueShield</option>
                  <option value="Humana">Humana</option>
                  <option value="Magellan">Magellan</option>
                  <option value="Optum">Optum</option>
                  <option value="Oscar Health">Oscar Health</option>
                  <option value="Oxford">Oxford</option>
                  <option value="United Healthcare">United Healthcare</option>
                </select>
              </div>
            </div>
            <button class="btn-find" onclick="filterTherapists()">Find care</button>
          </div>
        </div>
        <div class="hero-image">
          Hero image placeholder
        </div>
      </div>
    </div>
  </section>

  <!-- ===== COST ESTIMATE BANNER ===== -->
  <div class="cost-banner">
    <div class="cost-banner-inner">
      <div class="cost-banner-left">
        <div class="cost-icon">ðŸ’³</div>
        <div>
          <h4>Get a cost estimate</h4>
          <p>People with insurance pay as low as $0 per session through Headway</p>
        </div>
      </div>
      <a href="#" class="arrow-link">&rarr;</a>
    </div>
  </div>

  <!-- ===== TOP THERAPISTS ===== -->
  <section class="therapists-section">
    <div class="container">
      <h3 class="font-serif">Top family therapists in New York</h3>
      <p class="therapists-intro">
        Family challenges affect everyone differently. Headway's network of 2,299 providers across New York delivers personalized talk therapy and medication management for family-related concerns, with sessions as affordable as $0 through insurance.
      </p>

      <div class="view-toggle-bar">
        <div></div>
        <div class="view-toggle">
          <button class="active" onclick="setView('list')" id="listViewBtn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>
            List
          </button>
          <button onclick="setView('map')" id="mapViewBtn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"/><line x1="8" y1="2" x2="8" y2="18"/><line x1="16" y1="6" x2="16" y2="22"/></svg>
            Map
          </button>
        </div>
      </div>

      <!-- Map View -->
      <div class="map-container" id="mapContainer">
        <svg class="map-svg" id="mapSvg"></svg>
        <div class="map-popup" id="mapPopup"></div>
        <div class="map-legend">
          <div class="map-legend-row"><div class="map-legend-dot" style="background:#166534;"></div> Therapist location</div>
          <div class="map-legend-row"><div class="map-legend-dot" style="background:#93c5fd;opacity:0.4;"></div> Water</div>
        </div>
      </div>

      <div class="card-grid" id="cardGrid">
        <!-- Cards loaded dynamically from therapists.json -->
      </div>
      <div id="noResults" style="display:none;text-align:center;padding:48px 0;color:#6b7280;">
        <p style="font-size:18px;margin-bottom:8px;">No therapists found matching your filters.</p>
        <p style="font-size:14px;">Try changing your insurance selection or clearing the zip code filter.</p>
      </div>

      <!-- Pagination -->
      <div class="pagination">
        <button class="active">1</button>
      </div>
      <div class="pagination-info">
        Showing 12 of 12 <a href="#">available therapists</a>
      </div>
    </div>
  </section>

  <!-- ===== FAQ ===== -->
  <section class="faq-section">
    <div class="container">
      <div class="faq-inner">
        <div class="faq-left">
          <h3 class="font-serif">Frequently asked questions</h3>
          <div class="faq-illustration"></div>
        </div>
        <div class="faq-right">
          <div class="faq-item">
            <button class="faq-question" onclick="this.parentElement.classList.toggle('open')">
              What kind of therapy is best for family counseling?
              <span class="faq-chevron">&#8964;</span>
            </button>
            <div class="faq-answer">
              Family therapy often draws on systemic, cognitive-behavioral, and structural approaches. The best type depends on your family's specific needs and dynamics. A qualified therapist can help determine the most effective approach during an initial consultation.
            </div>
          </div>
          <div class="faq-item">
            <button class="faq-question" onclick="this.parentElement.classList.toggle('open')">
              How much does family counseling cost in New York?
              <span class="faq-chevron">&#8964;</span>
            </button>
            <div class="faq-answer">
              The cost of family counseling in New York varies based on your insurance coverage. With insurance through Headway, sessions can cost as low as $0. Without insurance, sessions typically range from $150-$300 per session.
            </div>
          </div>
          <div class="faq-item">
            <button class="faq-question" onclick="this.parentElement.classList.toggle('open')">
              Is family therapy covered by insurance in New York?
              <span class="faq-chevron">&#8964;</span>
            </button>
            <div class="faq-answer">
              Yes, many insurance plans cover family therapy in New York. Headway works with major insurance carriers to help make family counseling affordable. Check with your specific plan for details on your coverage.
            </div>
          </div>
          <div class="faq-item">
            <button class="faq-question" onclick="this.parentElement.classList.toggle('open')">
              How do I choose a family counseling specialist in New York?
              <span class="faq-chevron">&#8964;</span>
            </button>
            <div class="faq-answer">
              Consider factors like the therapist's specialties, therapeutic approach, availability, and whether they accept your insurance. Reading therapist bios and reviews can help you find a good match for your family's needs.
            </div>
          </div>
          <div class="faq-item">
            <button class="faq-question" onclick="this.parentElement.classList.toggle('open')">
              How should I prepare for family therapy sessions?
              <span class="faq-chevron">&#8964;</span>
            </button>
            <div class="faq-answer">
              Come with an open mind and willingness to communicate. It helps to think about your goals for therapy beforehand. Ensure all participating family members are aware of the session and are willing to engage in the process.
            </div>
          </div>
          <div class="faq-item">
            <button class="faq-question" onclick="this.parentElement.classList.toggle('open')">
              Is family therapy effective?
              <span class="faq-chevron">&#8964;</span>
            </button>
            <div class="faq-answer">
              Research consistently shows that family therapy is effective for a wide range of issues including communication problems, conflict resolution, behavioral issues, and mental health conditions. The effectiveness often depends on the commitment of all family members involved.
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== CTA SECTION ===== -->
  <section class="cta-section">
    <div class="container">
      <div class="cta-inner">
        <div class="cta-image"></div>
        <div class="cta-content">
          <h3 class="font-serif">Find the right counselor for your family</h3>
          <p>Headway makes it easier to find family-focused support â€” from finding the right provider, to understanding costs, to scheduling with ease.</p>
          <button class="btn-find-match">Find your match</button>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== FIND A PROVIDER TABS ===== -->
  <section class="provider-tabs-section">
    <div class="container">
      <h3 class="font-serif">Find a provider - your way</h3>
      <div class="tabs">
        <button class="tab-btn active" onclick="switchTab(event, 'specialties')">Specialties</button>
        <button class="tab-btn" onclick="switchTab(event, 'cities')">Cities</button>
        <button class="tab-btn" onclick="switchTab(event, 'states')">States</button>
      </div>
      <div id="specialties" class="tab-content active">
        <a href="#">ADHD</a>
        <a href="#">Addiction</a>
        <a href="#">Anxiety and depression</a>
        <a href="#">Bipolar disorder</a>
        <a href="#">Couples</a>
        <a href="#">Grief and loss</a>
        <a href="#">LGBTQIA+</a>
        <a href="#">Maternal mental health</a>
        <a href="#">OCD</a>
        <a href="#">PTSD and trauma</a>
      </div>
      <div id="cities" class="tab-content">
        <a href="#">New York City</a>
        <a href="#">Los Angeles</a>
        <a href="#">Chicago</a>
        <a href="#">Houston</a>
        <a href="#">Phoenix</a>
        <a href="#">Philadelphia</a>
        <a href="#">San Antonio</a>
        <a href="#">San Diego</a>
      </div>
      <div id="states" class="tab-content">
        <a href="#">New York</a>
        <a href="#">California</a>
        <a href="#">Texas</a>
        <a href="#">Florida</a>
        <a href="#">Illinois</a>
        <a href="#">Pennsylvania</a>
        <a href="#">Ohio</a>
        <a href="#">Georgia</a>
      </div>
    </div>
  </section>

  <!-- ===== BREADCRUMBS ===== -->
  <div class="container">
    <div class="breadcrumbs">
      <div class="breadcrumbs-nav">
        <a href="#">Home</a> <span>&rsaquo;</span>
        <a href="#">Therapists</a> <span>&rsaquo;</span>
        <a href="#">New York</a> <span>&rsaquo;</span>
        <span>Family</span>
      </div>
      <div>Last updated February 16, 2026</div>
    </div>
  </div>

  <!-- ===== DISCLAIMER ===== -->
  <div class="container">
    <div class="disclaimer">
      <sup>1</sup> Cost may vary based on your location, age, and insurance coverage.
    </div>
  </div>

  <!-- ===== FOOTER ===== -->
  <footer class="footer">
    <div class="container">
      <div class="footer-top">
        <div>
          <div class="footer-logo">
            <svg viewBox="0 0 32 32" width="32" height="32" fill="none">
              <rect width="32" height="24" rx="6" fill="#166534" y="8"/>
              <rect width="22" height="16" rx="4" fill="#16a34a" x="5" y="2"/>
            </svg>
            Headway
          </div>
        </div>
        <div class="footer-col">
          <h4>Find care</h4>
          <a href="#">Therapists</a>
          <a href="#">Psychiatrists</a>
          <a href="#">By specialty</a>
          <a href="#">Virtual therapy</a>
        </div>
        <div class="footer-col">
          <h4>Providers</h4>
          <a href="#">Join Headway</a>
          <a href="#">Provider portal</a>
          <a href="#">Refer provider</a>
          <a href="#">Provider resources</a>
        </div>
        <div class="footer-col">
          <h4>Company</h4>
          <a href="#">About us</a>
          <a href="#">Blog</a>
          <a href="#">Press</a>
          <a href="#">Careers</a>
        </div>
        <div class="footer-col">
          <h4>Support</h4>
          <a href="#">Help center</a>
          <a href="#">Contact us</a>
          <a href="#">Sitemap</a>
        </div>
      </div>
      <div class="footer-bottom">
        <div>
          <div>&copy; 2026 Therapymatch, Inc.</div>
          <div class="footer-social">
            <a href="#" title="Instagram">&#9679;</a>
            <a href="#" title="X">&#10005;</a>
            <a href="#" title="LinkedIn">in</a>
          </div>
        </div>
        <div class="footer-crisis">
          <p>If you're experiencing emotional distress, the resources below provide free and confidential support 24/7. <strong>If this is an emergency, call 911.</strong></p>
          <p style="margin-top: 12px;"><a href="#">Suicide Prevention Lifeline</a><br>Call or text 988</p>
          <p style="margin-top: 12px;"><a href="#">Crisis Text Line</a><br>Text HOME to 741741</p>
        </div>
        <div class="footer-legal">
          <a href="#">Terms of Service</a>
          <a href="#">Privacy Policy</a>
          <a href="#">Supplemental Payment Terms</a>
          <a href="#">HIPAA Notice of Privacy Practices</a>
          <a href="#">CA Privacy Policy for Business Customers</a>
          <a href="#">Washington State Consumer Health Data Privacy Policy</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- ===== STICKY BOTTOM BAR ===== -->
  <div class="sticky-bar">
    <p>Not sure who's the right fit? Filter 2,299 therapists with your preferences</p>
    <button class="btn-get-started">Get started</button>
  </div>

  <!-- Add padding at bottom so sticky bar doesn't cover content -->
  <div style="height: 60px;"></div>

  <script src="therapists.js"></script>
  <script>
    // ===== STATE =====
    let allTherapists = THERAPISTS_DATA;
    let filteredTherapists = THERAPISTS_DATA;

    // ===== SVG ICON TEMPLATES =====
    const icons = {
      heart: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>',
      people: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>',
      check: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>'
    };

    // ===== RENDER CARDS =====
    function renderCards(therapists) {
      const grid = document.getElementById('cardGrid');
      const noResults = document.getElementById('noResults');

      if (therapists.length === 0) {
        grid.style.display = 'none';
        noResults.style.display = 'block';
        return;
      }

      grid.style.display = currentView === 'list' ? '' : 'none';
      noResults.style.display = 'none';

      grid.innerHTML = therapists.map(t => {
        const hasFamilyIssues = t.specialties.some(s => s.toLowerCase().includes('family'));
        const specialtiesHtml = hasFamilyIssues
          ? '<strong>Family issues</strong>, ' + t.specialties.filter(s => !s.toLowerCase().includes('family')).join(', ')
          : t.specialties.join(', ');

        return `
          <div class="therapist-card">
            <div class="card-header">
              <div class="card-avatar" style="background: ${t.avatarGradient};">${t.initials}</div>
              <div>
                <div class="card-name font-serif">${t.name}</div>
                <div class="card-role">${t.role}</div>
                <div class="card-location">Virtual &bull; ${t.location}</div>
              </div>
            </div>
            <div class="card-quote">&ldquo;${t.quote}&rdquo;</div>
            <div class="card-detail">
              <div class="card-detail-icon">${icons.heart}</div>
              <div>${specialtiesHtml}</div>
            </div>
            <div class="card-detail">
              <div class="card-detail-icon">${icons.people}</div>
              <div>${t.style.join(', ')}</div>
            </div>
            <div class="card-detail">
              <div class="card-detail-icon">${icons.check}</div>
              <div>Accepts ${t.insurance.length} insurance carriers</div>
            </div>
            <div class="card-footer">
              <div>
                <div class="next-opening">Next opening ${t.nextOpening}</div>
                ${t.freeConsultation ? '<div class="free-consult">Offers free consultations</div>' : ''}
              </div>
              <a href="provider.html?id=${t.id}" class="btn-view-profile">View profile and book</a>
            </div>
          </div>
        `;
      }).join('');
    }

    // ===== FILTER =====
    function filterTherapists() {
      const zip = document.getElementById('zipInput').value.trim();
      const insurance = document.getElementById('insuranceSelect').value;

      filteredTherapists = allTherapists.filter(t => {
        // Zip code filter: if user entered a zip, only show therapists whose zip starts with same first 3 digits (same area)
        if (zip.length >= 3) {
          const zipPrefix = zip.substring(0, 3);
          const therapistPrefix = t.zipCode.substring(0, 3);
          // Show all NYC-area zips (100xx, 110xx, 070xx) as matching each other
          const nyArea = ['100', '101', '102', '103', '104', '110', '111', '112', '113', '070', '071'];
          const userInNY = nyArea.some(p => zip.startsWith(p));
          const therapistInNY = nyArea.some(p => t.zipCode.startsWith(p));
          if (!(userInNY && therapistInNY) && zipPrefix !== therapistPrefix) {
            return false;
          }
        }

        // Insurance filter
        if (insurance) {
          const hasInsurance = t.insurance.some(ins =>
            ins.toLowerCase().includes(insurance.toLowerCase())
          );
          if (!hasInsurance) return false;
        }

        return true;
      });

      renderCards(filteredTherapists);
      updateCount(filteredTherapists.length);
      if (currentView === 'map') renderMap(filteredTherapists);
    }

    function updateCount(count) {
      const info = document.querySelector('.pagination-info');
      if (info) {
        info.innerHTML = `Showing ${count} of ${allTherapists.length} <a href="#">available therapists</a>`;
      }
      const stickyP = document.querySelector('.sticky-bar p');
      if (stickyP) {
        stickyP.textContent = `Not sure who's the right fit? Filter ${allTherapists.length} therapists with your preferences`;
      }
    }

    // Also filter when pressing Enter in zip input
    document.addEventListener('DOMContentLoaded', () => {
      const zipInput = document.getElementById('zipInput');
      if (zipInput) {
        zipInput.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') filterTherapists();
        });
      }
    });

    // ===== TAB SWITCHING =====
    function switchTab(event, tabId) {
      document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      event.target.classList.add('active');
      document.getElementById(tabId).classList.add('active');
    }

    // ===== ZIP CODE â†’ COORDINATES =====
    const ZIP_COORDS = {
      '10001':[40.7484,-73.9967],'10002':[40.7157,-73.9863],'10003':[40.7317,-73.9893],
      '10004':[40.6993,-74.0384],'10005':[40.7069,-74.0089],'10006':[40.7094,-74.0131],
      '10007':[40.7135,-74.0079],'10008':[40.7112,-74.0006],'10009':[40.7265,-73.9797],
      '10010':[40.7390,-73.9826],'10011':[40.7418,-74.0002],'10013':[40.7198,-74.0030],
      '10014':[40.7337,-74.0061],'10018':[40.7549,-73.9928],'10019':[40.7654,-73.9851],
      '10020':[40.7587,-73.9787],'10021':[40.7693,-73.9586],'10022':[40.7587,-73.9680],
      '10023':[40.7764,-73.9825],'10024':[40.7885,-73.9760],'10025':[40.7982,-73.9667],
      '10026':[40.8025,-73.9530],'10027':[40.8116,-73.9530],'10028':[40.7765,-73.9539],
      '10030':[40.8182,-73.9433],'10031':[40.8244,-73.9500],'10032':[40.8389,-73.9422],
      '10033':[40.8497,-73.9346],'10034':[40.8672,-73.9227],'10035':[40.7957,-73.9395],
      '10036':[40.7590,-73.9903],'10039':[40.8240,-73.9370],'10040':[40.8580,-73.9296],
      '10453':[40.8530,-73.9127],'10458':[40.8621,-73.8880],'10459':[40.8244,-73.8927],
      '10462':[40.8424,-73.8577],'10469':[40.8695,-73.8514],'10470':[40.8950,-73.8670],
      '10471':[40.8997,-73.9003],'11103':[40.7632,-73.9130],'11104':[40.7444,-73.9204],
      '11106':[40.7623,-73.9288],'11201':[40.6934,-73.9898],'11206':[40.7024,-73.9420],
      '11207':[40.6707,-73.8862],'11208':[40.6663,-73.8717],'11210':[40.6282,-73.9466],
      '11212':[40.6632,-73.9130],'11215':[40.6620,-73.9858],'11216':[40.6811,-73.9495],
      '11218':[40.6435,-73.9752],'11219':[40.6333,-73.9969],'11220':[40.6414,-74.0163],
      '11221':[40.6909,-73.9273],'11222':[40.7272,-73.9480],'11226':[40.6463,-73.9565],
      '11229':[40.6013,-73.9437],'11232':[40.6567,-74.0055],'11239':[40.6485,-73.8788],
      '11354':[40.7681,-73.8276],'11362':[40.7614,-73.7367],'11369':[40.7636,-73.8711],
      '11370':[40.7653,-73.8924],'11373':[40.7388,-73.8785],'11375':[40.7207,-73.8467],
      '11377':[40.7447,-73.9048],'11378':[40.7258,-73.9085],'11379':[40.7168,-73.8789],
      '11385':[40.7004,-73.8896],
      '07010':[40.8224,-74.0590],'07014':[40.8550,-74.1460],'07018':[40.7470,-74.2106],
      '07021':[40.8260,-74.1280],'07027':[40.6574,-74.2350],
      '90210':[34.0901,-118.4065],'96801':[21.3069,-157.8583]
    };

    // Map bounds (NYC metro area)
    const MAP_BOUNDS = { latMin: 40.56, latMax: 40.92, lngMin: -74.28, lngMax: -73.70 };

    // ===== VIEW TOGGLE =====
    let currentView = 'list';

    function setView(view) {
      currentView = view;
      document.getElementById('listViewBtn').classList.toggle('active', view === 'list');
      document.getElementById('mapViewBtn').classList.toggle('active', view === 'map');
      document.getElementById('cardGrid').style.display = view === 'list' ? '' : 'none';
      document.getElementById('mapContainer').classList.toggle('active', view === 'map');
      if (view === 'map') renderMap(filteredTherapists);
    }

    // ===== MAP RENDERING =====
    function renderMap(therapists) {
      const svg = document.getElementById('mapSvg');
      const container = document.getElementById('mapContainer');
      const w = container.clientWidth;
      const h = container.clientHeight;
      const pad = 40;

      function toXY(lat, lng) {
        const x = pad + ((lng - MAP_BOUNDS.lngMin) / (MAP_BOUNDS.lngMax - MAP_BOUNDS.lngMin)) * (w - pad * 2);
        const y = pad + ((MAP_BOUNDS.latMax - lat) / (MAP_BOUNDS.latMax - MAP_BOUNDS.latMin)) * (h - pad * 2);
        return [x, y];
      }

      // Water features (simplified polygons for Hudson, East River, Upper Bay)
      const water = [
        // Hudson River (west side of Manhattan)
        [[40.70,-74.025],[40.72,-74.015],[40.75,-74.005],[40.78,-73.998],[40.82,-73.960],[40.87,-73.940],[40.90,-73.935],[40.92,-73.930],[40.92,-74.030],[40.87,-74.020],[40.82,-74.020],[40.78,-74.020],[40.75,-74.018],[40.72,-74.025],[40.70,-74.035]],
        // East River
        [[40.70,-73.975],[40.72,-73.970],[40.74,-73.965],[40.76,-73.955],[40.78,-73.940],[40.80,-73.930],[40.82,-73.910],[40.82,-73.920],[40.80,-73.938],[40.78,-73.948],[40.76,-73.962],[40.74,-73.972],[40.72,-73.978],[40.70,-73.983]],
        // Upper Bay
        [[40.70,-74.035],[40.70,-73.975],[40.68,-73.970],[40.66,-73.980],[40.64,-74.000],[40.62,-74.020],[40.60,-74.040],[40.62,-74.060],[40.65,-74.055],[40.68,-74.040]],
        // Jamaica Bay (rough)
        [[40.62,-73.880],[40.64,-73.850],[40.63,-73.830],[40.60,-73.840],[40.58,-73.860],[40.59,-73.890],[40.61,-73.900]]
      ];

      let waterPaths = '';
      water.forEach(poly => {
        const points = poly.map(([lat, lng]) => {
          const [x, y] = toXY(lat, lng);
          return `${x},${y}`;
        }).join(' ');
        waterPaths += `<polygon points="${points}" fill="#93c5fd" opacity="0.3"/>`;
      });

      // Group therapists by zip code to avoid overlapping pins
      const byZip = {};
      therapists.forEach(t => {
        const coords = ZIP_COORDS[t.zipCode];
        if (!coords) return;
        const [lat, lng] = coords;
        if (lat < MAP_BOUNDS.latMin || lat > MAP_BOUNDS.latMax || lng < MAP_BOUNDS.lngMin || lng > MAP_BOUNDS.lngMax) return;
        if (!byZip[t.zipCode]) byZip[t.zipCode] = [];
        byZip[t.zipCode].push(t);
      });

      // Count therapists outside bounds
      let outsideCount = 0;
      therapists.forEach(t => {
        const coords = ZIP_COORDS[t.zipCode];
        if (!coords) return;
        const [lat, lng] = coords;
        if (lat < MAP_BOUNDS.latMin || lat > MAP_BOUNDS.latMax || lng < MAP_BOUNDS.lngMin || lng > MAP_BOUNDS.lngMax) outsideCount++;
      });

      let pins = '';
      Object.entries(byZip).forEach(([zip, group]) => {
        const [lat, lng] = ZIP_COORDS[zip];
        const [x, y] = toXY(lat, lng);
        const count = group.length;
        const r = Math.min(6 + count * 1.5, 14);

        // Jitter slightly for same-zip therapists but render as single pin with count
        pins += `<circle class="map-pin" cx="${x}" cy="${y}" r="${r}" fill="#166534" opacity="0.85" stroke="#fff" stroke-width="2" data-zip="${zip}"/>`;
        if (count > 1) {
          pins += `<text x="${x}" y="${y + 1}" text-anchor="middle" dominant-baseline="middle" fill="#fff" font-size="10" font-weight="700" pointer-events="none">${count}</text>`;
        }
      });

      // Outside-bounds note
      let outsideNote = '';
      if (outsideCount > 0) {
        outsideNote = `<text x="${w - pad}" y="${pad - 10}" text-anchor="end" fill="#6b7280" font-size="12">${outsideCount} therapist${outsideCount > 1 ? 's' : ''} outside NYC area (not shown)</text>`;
      }

      svg.innerHTML = `
        <rect width="${w}" height="${h}" fill="#eef1f5" rx="16"/>
        ${waterPaths}
        ${pins}
        ${outsideNote}
      `;

      // Add click handlers
      svg.querySelectorAll('.map-pin').forEach(pin => {
        pin.addEventListener('click', (e) => {
          const zip = pin.getAttribute('data-zip');
          const group = byZip[zip];
          showMapPopup(group, e.clientX, e.clientY, container);
        });
      });

      // Close popup on background click
      svg.addEventListener('click', (e) => {
        if (!e.target.classList.contains('map-pin')) {
          document.getElementById('mapPopup').classList.remove('visible');
        }
      });
    }

    function showMapPopup(therapists, mouseX, mouseY, container) {
      const popup = document.getElementById('mapPopup');
      const rect = container.getBoundingClientRect();
      let left = mouseX - rect.left + 12;
      let top = mouseY - rect.top - 20;

      // Keep popup in bounds
      if (left + 300 > rect.width) left = left - 320;
      if (top + 250 > rect.height) top = rect.height - 260;
      if (top < 10) top = 10;

      const t = therapists[0];
      const moreCount = therapists.length - 1;

      let moreHtml = '';
      if (moreCount > 0) {
        const others = therapists.slice(1, 4).map(o =>
          `<a href="provider.html?id=${o.id}" style="display:block;padding:4px 0;font-size:13px;color:var(--green-dark);">${o.name} &mdash; ${o.role}</a>`
        ).join('');
        const remaining = moreCount > 3 ? `<span style="font-size:12px;color:var(--text-secondary);">+${moreCount - 3} more nearby</span>` : '';
        moreHtml = `<div style="border-top:1px solid var(--border-color);margin-top:10px;padding-top:10px;">${others}${remaining}</div>`;
      }

      popup.innerHTML = `
        <button class="map-popup-close" onclick="document.getElementById('mapPopup').classList.remove('visible')">&times;</button>
        <div class="map-popup-header">
          <div class="map-popup-avatar" style="background:${t.avatarGradient};">${t.initials}</div>
          <div>
            <div class="map-popup-name font-serif">${t.name}</div>
            <div class="map-popup-role">${t.role} &bull; ${t.location}</div>
          </div>
        </div>
        <div class="map-popup-detail">${t.specialties.slice(0, 3).join(', ')}</div>
        <div class="map-popup-detail">Next opening: ${t.nextOpening}</div>
        <a href="provider.html?id=${t.id}" class="map-popup-link">View profile</a>
        ${moreHtml}
      `;

      popup.style.left = left + 'px';
      popup.style.top = top + 'px';
      popup.classList.add('visible');
    }

    // ===== RESIZE HANDLER =====
    window.addEventListener('resize', () => {
      if (currentView === 'map') renderMap(filteredTherapists);
    });

    // ===== INIT =====
    renderCards(allTherapists);
    updateCount(allTherapists.length);
  </script>

</body>
</html>
